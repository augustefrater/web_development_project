{% load static %}
<!DOCTYPE html>
<!-- Declares this document as HTML5 -->

<html lang="en">
<!-- Sets the primary language of the page to English -->

<head>
  <meta charset="UTF-8">
  <!-- Ensures that the document uses UTF-8 encoding to support all characters -->

  <title>Report a Fault</title>
  <!-- The title that appears in the browser tab -->

  <!-- Link to the external CSS file (served via Django static files system) -->
  <link rel="stylesheet" href="{% static 'myapp/fault_report.css' %}">
</head>

<body>
  <!-- Top navigation bar -->
  <div id="navbar">
    <div class="logo">
      <!-- Branding: project name in bold and primary color -->
      <span style="font-weight: 700; color: var(--primary);">MachineMonitor</span>
    </div>

    <!-- Navigation links -->
    <div class="nav-items">
      <a href="{% url 'index' %}">Home</a> <!-- Goes to index page -->
      <a href="{% url 'dashboard' %}">Dashboard</a> <!-- Dashboard page -->
      <a href="{% url 'fault_report' %}">Report Fault</a> <!-- Fault report form -->
      <a href="{% url 'profile' %}">Profile</a> <!-- User profile page -->
    </div>
  </div>
  <!-- Main container to center and structure the page content -->
  <div class="container">
    
    <!-- Main title of the page -->
    <h2>Report a Machine Fault</h2>

    <!-- The form to submit a new fault report -->
    <form id="fault-form">
      <!-- CSRF token for security, required by Django to validate POST requests -->
      <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">

      <!-- Dropdown to select a machine (filled dynamically with JavaScript) -->
      <label for="machine">Machine:</label>
      <select id="machine" name="machine" required></select><br><br>

      <!-- Text area where the user describes the fault -->
      <label for="note">Note:</label><br>
      <textarea id="note" name="note" required></textarea><br><br>

      <!-- Input field for uploading one or more images (accepts only image files) -->
      <label for="images">Upload images:</label><br>
      <input type="file" id="images" name="image" multiple accept="image/*"><br><br>

      <!-- Submit button: sends the fault data and images to the server using JavaScript -->
      <button type="submit">Submit Fault</button>
    </form>

    <!-- Section showing which user is logged in, placed below the form for clarity -->
    <div class="user-info">
      <p class="logged-user">Logged in as: <strong>{{ request.user.username }}</strong></p>
    </div>

    <!-- Placeholder for displaying success or error messages from the form submission -->
    <p id="result"></p>
    <!-- Spinner (hidden by default) -->
    <div id="loading-spinner" class="spinner" style="display: none;"></div>

  </div>

  <!-- Page footer -->
  <div id="footer">
    Â© 2025 MachineMonitor Dashboard | Version 2.3.1
  </div>
  <!-- Link to the JavaScript file that handles form logic, machine loading, and image upload -->
  <script src="{% static 'myapp/fault_report.js' %}"></script>
</body>

</html>